<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Frostville Winter Mystery</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #001f3f;
            color: white;
            overflow-x: hidden;
        }
        .game-container {
            max-width: 800px;
            margin: 0 auto;
            background-color: #0B5345; /* Darker green */
            padding: 20px;
            border-radius: 10px;
        }
        .header-image {
            width: 100%;
            max-width: 600px;
            height: auto;
            margin: 0 auto 20px;
            display: block;
            cursor: pointer;
        }
        h1, h2 {
            text-align: center;
        }
        .grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }
        .cell {
            background-color: #B22222; /* Change to red */
            border: 1px solid #FF6347;
            padding: 10px;
            text-align: center;
        }
        .choices {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
        }
        .choice-category {
            background-color: #B22222; /* Change to red */
            border-radius: 5px;
            padding: 10px;
        }
        .choice-item {
            display: flex;
            align-items: center;
            margin: 10px 0;
            cursor: pointer;
        }
        .choice-item img {
            width: 30px;
            height: 30px;
            margin-right: 10px;
            object-fit: contain;
        }
        button {
            display: block;
            margin: 20px auto;
            padding: 10px 20px;
            background-color: #B22222; /* Change to red */
            border: none;
            color: white;
            cursor: pointer;
        }
        button:hover {
            background-color: #8B0000;
        }
        .clue-buttons {
            display: flex;
            justify-content: space-around;
            margin-top: 20px;
        }
        .clue-button {
            width: 50px;
            height: 50px;
            background-color: transparent;
            border: none;
            cursor: pointer;
            transition: transform 0.3s ease;
            padding: 0;
        }
        .clue-button:hover {
            transform: scale(1.1);
        }
        .clue-button img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }
        .snowflake {
            color: #fff;
            font-size: 2em; /* Increase size of snowflakes */
            font-family: Arial, sans-serif;
            text-shadow: 0 0 5px #000;
            position: fixed;
            top: -10%;
            z-index: -1;
            user-select: none;
            cursor: default;
            animation: fall 10s linear infinite;
        }
        @keyframes fall {
            0% {
                opacity: 0;
            }
            3% {
                opacity: 0.9;
            }
            90% {
                opacity: 0.9;
            }
            100% {
                transform: translate(0, 97vh);
                opacity: 0;
            }
        }
        .star {
            position: fixed;
            width: 5px;
            height: 6px;
            background: yellow;
            border-radius: 50%;
            z-index: -2;
              box-shadow: 0 0 4px 1px yellow;
        }
        .modal {
            display: none;
            position: fixed;
            z-index: 1;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.4);
        }
        .modal-content {
            background-color: #B22222; /* Change to red */
            margin: 15% auto;
            padding: 20px;
            border: 1px solid #888;
            width: 80%;
            max-width: 600px;
            color: white;
        }
        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }
        .close:hover,
        .close:focus {
            color: #fff;
            text-decoration: none;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <img src="images/frostville-header.png" alt="Frostville Winter Mystery" class="header-image" onclick="openModal()">

    <div id="contextModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal()">&times;</span>
            <h2>Welcome to the Frostville Winter Mystery!</h2>
            <p>'Twas a week before Christmas and Frostville was buzzing with excitement for its annual Christmas extravaganza. The Christmas market in the town square sparkled with twinkling lights as visitors flocked from far and wide to ride the giant ferris wheel, tuck into delicious roasted chestnuts, and sip steaming hot chocolate from the cosy winter bar. Inside the town hall, a magical craft market offered every Christmas gift imaginable, handmade with love and holiday cheer. Visitors left Frostville full of festive cheer, excited for the Christmas celebrations to come.</p>
            <p>But this year was different. Just days after leaving Frostville, some of the people who attended began to feel unwell. Could something sinister have crept into Frostville's winter wonderland? It's up to you to uncover the mystery! Track down what this illness is, figure out how it spread through Frostville, and use the clues to crack the puzzle. Can you save Christmas in time?</p>
            <p>Enter your answers to see if you solved the mystery. After submitting your answers, you have the opportunity to enter a competition to win XXX.</p>
        </div>
    </div>

    <div class="game-container">
        <h1>What caused the mystery outbreak?</h1>

        <div class="grid">
            <div class="cell">Bug</div>
            <div class="cell">Transmission mechanism</div>
            <div class="cell">Outbreak location</div>
            
            <div id="suspect-guess" class="cell"></div>
            <div id="transmission-guess" class="cell"></div>
            <div id="location-guess" class="cell"></div>
        </div>
        
        <h2>Click to select a suspect</h2>
        <div class="choices">
            <div class="choice-category">
                <h3>Suspected bugs</h3>
                <div class="choice-item" onclick="selectChoice('suspect', 'Norovirus')">
                    <img src="images/norovirus.png" alt="Norovirus">
                    <span>Norovirus</span>
                </div>
                <div class="choice-item" onclick="selectChoice('suspect', 'Strep A')">
                    <img src="images/strepa.png" alt="Strep A">
                    <span>Strep A</span>
                </div>
                <div class="choice-item" onclick="selectChoice('suspect', 'Influenza')">
                    <img src="images/influenza.png" alt="Influenza">
                    <span>Influenza</span>
                </div>
            </div>
            <div class="choice-category">
                <h3>Suspected transmission mechanisms</h3>
                <div class="choice-item" onclick="selectChoice('transmission', 'Spread through the air via droplets')">
                    <img src="/api/placeholder/30/30" alt="Spread through the air via droplets">
                    <span>Spread through the air via droplets</span>
                </div>
                <div class="choice-item" onclick="selectChoice('transmission', 'Spread through contaminated food')">
                    <img src="/api/placeholder/30/30" alt="Spread through contaminated food">
                    <span>Spread through contaminated food</span>
                </div>
                <div class="choice-item" onclick="selectChoice('transmission', 'Spread through surface-to-surface contact')">
                    <img src="/api/placeholder/30/30" alt="Spread through surface-to-surface contact">
                    <span>Spread through surface-to-surface contact</span>
                </div>
            </div>
            <div class="choice-category">
                <h3>Suspected outbreak locations</h3>
                <div class="choice-item" onclick="selectChoice('location', 'The Christmas market in the town square')">
                    <img src="/api/placeholder/30/30" alt="The Christmas market in the town square">
                    <span>The Christmas market in the town square</span>
                </div>
                <div class="choice-item" onclick="selectChoice('location', 'The craft market inside the town hall')">
                    <img src="/api/placeholder/30/30" alt="The craft market inside the town hall">
                    <span>The craft market inside the town hall</span>
                </div>
                <div class="choice-item" onclick="selectChoice('location', 'The roasted chestnut stall')">
                    <img src="/api/placeholder/30/30" alt="The roasted chestnut stall">
                    <span>The roasted chestnut stall</span>
                </div>
            </div>
        </div>
        
        <button onclick="submitGuess()">Submit Guess</button>
        <div class="clue-buttons">
            <button class="clue-button" onclick="getClue(0)"><img src="images/snowman1.png" alt="Clue 1"></button>
            <button class="clue-button" onclick="getClue(1)"><img src="images/snowman2.png" alt="Clue 2"></button>
            <button class="clue-button" onclick="getClue(2)"><img src="images/snowman3.png" alt="Clue 3"></button>
            <button class="clue-button" onclick="getClue(3)"><img src="images/snowman4.png" alt="Clue 4"></button>
            <button class="clue-button" onclick="getClue(4)"><img src="images/snowman5.png" alt="Clue 5"></button>
        </div>
        <p id="clue"></p>
        <p id="result"></p>
    </div>

    <script>
        // Game logic
        const correctAnswer = {
            suspect: "Influenza",
            transmission: "Spread through the air via droplets",
            location: "The craft market inside the town hall"
        };

        const clues = [
            "This bug often causes outbreaks in crowded places.",
            "It's known for causing sudden onset of nausea and vomiting.",
            "This pathogen can survive on surfaces for long periods.",
            "It's often associated with contaminated food or water.",
            "This microbe is highly contagious and can spread quickly in a community."
        ];

        let currentGuess = {
            suspect: "",
            transmission: "",
            location: ""
        };

        let usedClues = new Set();

        function selectChoice(category, choice) {
            currentGuess[category] = choice;
            document.getElementById(`${category}-guess`).textContent = choice;
        }

        function submitGuess() {
            let correct = 0;
            for (let category in currentGuess) {
                if (currentGuess[category] === correctAnswer[category]) {
                    correct++;
                    document.getElementById(`${category}-guess`).style.backgroundColor = "green";
                } else {
                    document.getElementById(`${category}-guess`).style.backgroundColor = "red";
                }
            }

            const resultElement = document.getElementById('result');
            if (correct === 3) {
                resultElement.textContent = "Congratulations! You solved the mystery!";
            } else {
                resultElement.textContent = `You got ${correct} out of 3 correct. Try again!`;
            }
        }

        function getClue(index) {
            if (!usedClues.has(index)) {
                document.getElementById('clue').textContent = clues[index];
                usedClues.add(index);
                document.getElementsByClassName('clue-button')[index].style.visibility = 'hidden';
            }
        }

        function openModal() {
            document.getElementById('contextModal').style.display = 'block';
        }

        function closeModal() {
            document.getElementById('contextModal').style.display = 'none';
        }

        // Add stars to the background
       function addStars() {
    for (let i = 0; i < 30; i++) {  // Reduced from 100 to 30
        let star = document.createElement('div');
        star.className = 'star';
        star.style.left = Math.random() * window.innerWidth + 'px';
        star.style.top = Math.random() * window.innerHeight + 'px';
        star.style.width = Math.random() * 4 + 2 + 'px';  // Random size between 2-6px
        star.style.height = star.style.width;
        document.body.appendChild(star);
    }
}

        // Call the function to add stars
        addStars();

        // Create snowflakes
        function createSnowflake() {
            const snowflake = document.createElement('div');
            snowflake.classList.add('snowflake');
            snowflake.innerHTML = 'â„';
            snowflake.style.left = Math.random() * 100 + 'vw';
            snowflake.style.animationDuration = Math.random() * 3 + 7 + 's';
            snowflake.style.opacity = Math.random();
            snowflake.style.fontSize = Math.random() * 20 + 10 + 'px'; // Increase size range
            document.body.appendChild(snowflake);

            setTimeout(() => {
                snowflake.remove();
            }, 10000);
        }

        setInterval(createSnowflake, 100);

        // Close the modal if the user clicks outside of it
        window.onclick = function(event) {
            var modal = document.getElementById('contextModal');
            if (event.target == modal) {
                modal.style.display = 'none';
            }
        }
    </script>
</body>
</html>
